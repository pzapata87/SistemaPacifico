@model IEnumerable<SistemaPacifico.Models.VisitaModel>

@{
    ViewBag.Title = "Listar";
}

@using (Html.BeginForm("Index", "Visita", FormMethod.Post))
{
    <div class="container">
        <hr />
        <table width="85%" class="fondo" align="center">
            <tr>
                <td>Fecha Inicio: </td>
                <td><input type="text" class="form-control" id="txtFechaIni" value="@ViewBag.FechaIni" name="fechaIni" maxlength="10" /></td>
                <td>&nbsp;</td>
                <td>Fecha Fin: </td>
                <td><input id="txtFechaFin" type="text" class="form-control" value="@ViewBag.FechaFin" name="fechaFin" maxlength="10" /></td>
            </tr>
            <tr>
                <td>DNI Prospecto: </td>
                <td><input type="text" class="form-control" id="txtDni" value="@ViewBag.Dni" name="dniProspecto" maxlength="8" style="display: inline-block;" /></td>
                <td>&nbsp;</td>
                <td>Nombre Prospecto: </td>
                <td><input type="text" class="form-control" id="txtNombre" value="@ViewBag.Nombre" name="nombreProspecto" /></td>
                <td align="right"><button type="submit" class="btn btn-primary">Buscar</button></td>
            </tr>
        </table>
        <br/>
        <table class="table table-striped">
            <tr>
                <th>DNI</th>
                <th>Nombre</th>
                <th>Fecha Inicio</th>
                <th>Fecha Fin</th>
                <th>Tipo Visita</th>
                <th>&nbsp;</th>
                <th>&nbsp;</th>
            </tr>
            @if (Model.Any())
            {
                foreach (var item in Model)
                {
                    <tr>
                        <td>
                            @Html.DisplayFor(modelItem => item.DniProspecto)
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.NombreProspecto)
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.FechaInicial)
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.FechaFinal)
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.NombreTipoVisita)
                        </td>
                        <td>
                            @Html.ActionLink("Ver", "VerVisita", new { id = item.CodVisita })
                        </td>
                        <td>
                            @Html.ActionLink("Editar", "EditarVisita", new { id = item.CodVisita })
                        </td>
                    </tr>
                }
            }
            else
            {
                <tr>
                    <td colspan="8">
                        <div id="labelError" class="alert alert-danger">
                            No se encontraron visitas relacionadas
                        </div>
                    </td>
                </tr>
            }
        </table>
        <table style="width: 100%">
            <tr>
                <td>
                    <p>
                        <a href="@Url.Action("CrearVisita", "Visita")" class="btn btn-primary">Nuevo</a>
                    </p>
                </td>
            </tr>
        </table>
    </div>
    
    @section Scripts {
    <script src="@Url.Content("~/Scripts/datepicker-es.js")" type="text/javascript"></script>
    }

    <script type="text/javascript">
    $(document).ready(function () {
        $('#txtFechaIni').datepicker({
            option: $.datepicker.regional['es'],
            onClose: function (selectedDate) {
                $("#txtFechaFin").datepicker("option", "minDate", selectedDate);
            }
        });

        $('#txtFechaFin').datepicker({
            option: $.datepicker.regional['es'],
            onClose: function (selectedDate) {
                $("#txtFechaIni").datepicker("option", "maxDate", selectedDate);
            }
        });
    });
    </script>
}

